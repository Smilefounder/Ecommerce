@model PaymentMethodEditorModel

@using (Html.BeginForm("Save", "PaymentMethod", RouteValues.From(Request.QueryString)))
{
    @Html.HiddenFor(m => m.Id)
    @Html.ValidationSummary(true)
    <table>
        <tbody>
            <tr>
                <th>@Html.DisplayNameFor(m => m.PaymentGateway)</th>
                <td>
                    @if (Model.IsEdit)
                    {
                        @Html.HiddenFor(m => m.PaymentGateway)
                        @Model.PaymentGateway
                    }
                    else
                    {
                        @Html.DropDownListFor(m => m.PaymentGateway, Model.AvailableGateways, new { @class = "xxlarge" })
                    }
                </td>
            </tr>
            <tr>
                <th>@Html.DisplayNameFor(m => m.DisplayName)</th>
                <td>
                    @Html.TextBoxFor(m => m.DisplayName, new { @class = "xxlarge" })
                </td>
            </tr>
            <tr>
                <th>@Html.DisplayNameFor(m => m.AdditionalFeeChargeMode)</th>
                <td>
                    @Html.DropDownListFor(m => m.AdditionalFeeChargeMode, Model.AvailableAdditionalFeeChargeModes, new { @class = "xxlarge" })
                </td>
            </tr>
            <tr class="charge-amount" style="display:none">
                <th>@Html.DisplayNameFor(m => m.AdditionalFeeAmount)</th>
                <td>
                    @Html.TextBoxFor(m => m.AdditionalFeeAmount, new { @class = "xxlarge" })
                    @Html.ValidationMessageFor(m => m.AdditionalFeeAmount)
                </td>
            </tr>
            <tr class="charge-percent" style="display:none">
                <th>@Html.DisplayNameFor(m => m.AdditionalFeePercent)</th>
                <td>
                    @Html.TextBoxFor(m => m.AdditionalFeePercent, new { @class = "xxlarge" }) %
                    @Html.ValidationMessageFor(m => m.AdditionalFeePercent)
                </td>
            </tr>
            <tr>
                <th>@Html.DisplayNameFor(m => m.IsEnabled)</th>
                <td>
                    @Html.CheckBoxFor(m => m.IsEnabled)
                </td>
            </tr>
        </tbody>
    </table>
}

<script>
    $(function () {
        onChargeModeChanged($('select[name="AdditionalFeeChargeMode"]').val());

        $('select[name="AdditionalFeeChargeMode"]').change(function () {
            onChargeModeChanged($(this).val());
        });

        $('select[name="PaymentGateway"]').change(function () {
            var $name = $('input[name="DisplayName"]');
            $name.val($(this).find(':selected').text());
        });

        function onChargeModeChanged(mode) {
            if (mode == 'ByAmount') {
                $('.charge-amount').show();
                $('.charge-percent').hide();
            } else {
                $('.charge-amount').hide();
                $('.charge-percent').show();
            }
        }
    });
</script>